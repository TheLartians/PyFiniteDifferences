
\label{sec:discretization}

\begin{figure}[!ht]
  \centering
  \input{propagators/grid}
  \caption{We discretize the complex envelope into an euclidean grid of equidistantly spaced coordinates $x_i$, $y_j$, $z_k$ in the respective directions. Here each axis is split into $N_x = N_y = N_z = 6$ segments and begins at $x_\mathrm{min} = y_\mathrm{min} = z_\mathrm{min} = 0$. In the paraxial approximation the wave vector $\vec k$ is approximately parallel to the $z$ axis.}
\end{figure}


We now consider the complex envelope at discretized coordinate positions

\begin{align*}
u(x,y,z) \rightarrow u(x_i,y_j,z_k) := u_{i,j}^k,
\end{align*}

for $i \in \{0..N_x-1\}$ and $N_x$ equally distributed points  $x_i \in [x_\mathrm{min},x_\mathrm{max}]$ with distance $\Delta x = (x_\mathrm{max} - x_\mathrm{min})/(N_x-1)$. The definitions are analogous for $y_j$ and $z_k$.

If the field is assumed to be constant in $y$ direction, we can drop the explicit $y$ dependence, resulting in the 2D field:

\begin{align*}
u(x,y,z) = u(x,0,z) \rightarrow u(x_i,0,z_k) := u_{i}^k.
\end{align*}

 If the field $u_{i,j}^k$ for a given $k$ is known, we use a propagator to calculate the field at the next discretized $z$ value according to the the paraxial wave equation \eqref{eq:paraxial_wave_equation} and some boundary condition. We define the convenience variables $n_x = N_x - 2$ and $n_y = N_y - 2$.
 